"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[383],{6383:function(t,a,e){e.r(a);var r=e(2322),n=e(2784),s=e(5579),i=e(4640);let l=()=>{let{selectedPerson:t,directorData:a,shareholderData:e,setSelectedCompany:l}=(0,i.j)(),c=n.useRef(null),o=n.useRef(null),[d,p]=n.useState(),[h,g]=n.useState({width:0,height:0});n.useEffect(()=>{if(console.log("yeas"),d){let t=s.Ys(o.current),a=Number(h.width),e=Number(h.height);t.attr("width",a),t.attr("height",e);let r={TOP:10,RIGHT:10,BOTTOM:10,LEFT:10},n=a-r.LEFT-r.RIGHT,i=e-r.TOP-r.BOTTOM;t.select(".chart-margin").attr("width",n).attr("height",i).attr("transform","translate(".concat(r.LEFT,", ").concat(r.TOP,")"));let l=n>400?40:20,c=s.G_s().size([2*Math.PI,.4*n]).separation((t,a)=>(t.parent==a.parent?1:2)/t.depth),p=s.eRy().duration(500).tween("resize",()=>()=>t.dispatch("toggle")),g=t.select(".chart-area").attr("transform","translate(".concat(.5*n,",").concat(.5*i,")"));c(d).links();let f=(t,a)=>[(a=+a)*Math.cos(t-=Math.PI/2),a*Math.sin(t)],x=g.select(".node-layer");x.selectAll("g").remove();let v=x.selectAll("g").data(d.descendants()),y=v.enter().append("g").attr("fill-opacity",0).attr("stroke-opacity",0).attr("cursor","pointer").attr("pointer-events","all").on("click",(t,a)=>{u(a)});y.append("rect").attr("rx","5").attr("width",l).attr("height",l).attr("fill",t=>{var a;return(null===(a=t.data.companyData)||void 0===a?void 0:a.gov_fund_proj)?"#000":"white"}).attr("stroke","#000").attr("stroke-weight","2px").transition(p).attr("transform",t=>"rotate(".concat(180*t.x/Math.PI-90,") translate(").concat(t.y-.5*l,", ").concat(-(.5*l),")")).attr("fill-opacity",1).attr("stroke-opacity",1);let m=g.select(".link-layer");m.selectAll("line").remove();let k=m.selectAll(".link").data(d.links());k.enter().append("line").transition(p).attr("class","link").attr("stroke","#ccc").attr("stroke-opacity",1).attr("x1",t=>f(t.source.x,t.source.y)[0]).attr("y1",t=>f(t.source.x,t.source.y)[1]).attr("x2",t=>f(t.target.x,t.target.y)[0]).attr("y2",t=>f(t.target.x,t.target.y)[1]),g.selectAll("defs").remove();let w=g.select(".person-icon").append("svg:defs"),I=d.descendants()[0].data.personData;if(I){var _,j,P,N,T,E;w.append("svg:pattern").attr("id","pattern_person_avatar"+I.Id).attr("width",1).attr("height",1).attr("patternContentUnits","objectBoundingBox").append("use").attr("xlink:href","#person_avatar"+I.Id).attr("transform","scale(0.01)"),w.append("svg:image").attr("id","person_avatar"+I.Id).attr("xlink:href","string"==typeof I.Images?I.Images:"/mpasset/design_assets/profile_pic.jpg").attr("width",100).attr("height",100).attr("x",0).attr("y",0),I.Party&&(w.append("svg:pattern").attr("id","pattern_party_avatar"+(null===(j=I.Party)||void 0===j?void 0:j.Id)).attr("width",1).attr("height",1).attr("patternContentUnits","objectBoundingBox").append("use").attr("xlink:href","#party_avatar"+(null===(P=I.Party)||void 0===P?void 0:P.Id)).attr("transform","scale(0.01)"),w.append("svg:image").attr("id","party_avatar"+(null===(N=I.Party)||void 0===N?void 0:N.Id)).attr("xlink:href","string"==typeof(null===(T=I.Party)||void 0===T?void 0:T.Images)?null===(E=I.Party)||void 0===E?void 0:E.Images:"/mpasset/design_assets/profile_pic.jpg").attr("width",100).attr("height",100).attr("x",0).attr("y",0));let b=g.select(".person-icon").attr("transform","translate(".concat(-50," ").concat(-50,")"));b.selectAll("rect").remove(),b.append("rect").attr("width",100).attr("height",100).attr("rx",49).attr("stroke","#000").attr("stroke-width","2").attr("fill","url(#pattern_person_avatar"+I.Id+")").attr("stroke","black"),b.append("rect").attr("x",70).attr("y",70).attr("width",30).attr("height",30).attr("rx",49).attr("stroke",I.Party?"#000":"transparent").attr("stroke-width","2").attr("fill","url(#pattern_party_avatar"+(null===(_=I.Party)||void 0===_?void 0:_.Id)+")")}d.eachBefore(t=>{t.parent&&(t.x0=t.parent.x,t.y0=t.parent.y)})}},[o,d,h]),n.useEffect(()=>{if(t&&a&&e){let r=[{id:"pol-".concat(t.Id),parentId:"",personData:t},...a.map(a=>({id:"".concat(a.tsic),parentId:"pol-".concat(t.Id),companyData:a})),...e.map(a=>({id:"".concat(a.tsic),parentId:"pol-".concat(t.Id),companyData:a}))],n=s.QP8().id(t=>t.id).parentId(t=>t.parentId),i=n(r);i.descendants().forEach((t,a)=>{t._children=t.children,t.depth>0&&(t.children=void 0)}),p(i)}},[t,a,e]);let u=t=>{l(t.data.companyData),0!==t.height&&(t.children=t.children?void 0:t._children)};return n.useEffect(()=>{function t(){c.current&&g({width:c.current.clientWidth,height:c.current.clientHeight})}return window.addEventListener("resize",t),t(),()=>window.removeEventListener("resize",t)},[]),(0,r.jsx)("div",{className:"w-full h-full max-w-[800px] mx-auto",ref:c,children:(0,r.jsx)("svg",{ref:o,children:(0,r.jsxs)("g",{className:"chart-margin",children:[(0,r.jsx)("g",{className:"x-axis"}),(0,r.jsx)("g",{className:"y-axis"}),(0,r.jsx)("g",{className:"x-label",children:(0,r.jsx)("text",{})}),(0,r.jsx)("g",{className:"y-label",children:(0,r.jsx)("text",{})}),(0,r.jsxs)("g",{className:"chart-area",children:[(0,r.jsx)("g",{className:"link-layer"}),(0,r.jsx)("g",{className:"node-layer"}),(0,r.jsx)("g",{className:"person-icon"})]})]})})})};a.default=l}}]);