"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[419],{8419:function(e,t,a){a.r(t),a.d(t,{default:function(){return _}});var r,o,n,s,l=a(2322),c=a(2784),i=a(7725),d=a(1705),u=a(2382);let h="https://sheets.wevis.info";async function p(e,t){let{data:a}=await u.Z.get(`${h}/api/v1/db/public/shared-view/${e}/rows`,{params:t});return{...a.data,list:a.data.list.map(f)}}function f(e){return e.Images?{...e,Images:e.Images.map(({path:e,...t})=>e?{...t,url:`${h}/${e}`}:t)}:e}let b=(e,t)=>({fetch:a=>p(e,{...t,...a}),fetchAll:a=>m(e,{...t,...a})});async function m(e,t){let a=[],r=null;do{let o=await p(e,{...t,offset:r?r.page*r.pageSize:0,limit:200});a.push(...o.list),r=o.pageInfo}while(!r?.isLastPage);return a}(r=n||(n={})).Government="ร่วมรัฐบาล",r.Opposition="ฝ่ายค้าน";let S={Parties:b("40065196-c978-4d7a-b3fb-fb84694383a7"),People:b("572c5e5c-a3d8-440f-9a70-3c4c773543ec",{"nested[PeoplePartyHistory][fields]":"Party,EstablishedDate"}),VoteLog:b("e06d1465-2786-4799-9c0f-a20f4cf71ec4"),PeopleVotes:b("e58433cc-f4fd-499b-926d-05431412cbba"),Policies:b("4842fd3b-4f2c-45c7-b7e2-92f7e2e60ab2")};var P=a(1322),y=a(5237),C=a.n(y),E=a(2069);let g=e=>{let{children:t,open:a}=e;return(0,l.jsx)("div",{className:"absolute inset-0 bg-white bg-opacity-50 \n      flex flex-col justify-center items-center z-50 transition-all\n      ".concat(a?"visible opacity-100":"invisible opacity-0","\n      "),children:t})},N=C()(()=>Promise.all([a.e(765),a.e(620),a.e(810)]).then(a.bind(a,2810)),{loadableGenerated:{webpack:()=>[2810]},loading:()=>(0,l.jsx)(d.a,{})}),v=C()(()=>Promise.all([a.e(765),a.e(199)]).then(a.bind(a,8199)),{loadableGenerated:{webpack:()=>[8199]},loading:()=>(0,l.jsx)(d.a,{})}),D=C()(()=>Promise.all([a.e(765),a.e(620),a.e(371)]).then(a.bind(a,8371)),{loadableGenerated:{webpack:()=>[8371]},loading:()=>(0,l.jsx)(d.a,{})});(o=s||(s={}))[o.MAIN_VIEW=0]="MAIN_VIEW",o[o.SELCTED_PERSON_CHART=1]="SELCTED_PERSON_CHART",o[o.SELECTED_COMPANY_CHART=2]="SELECTED_COMPANY_CHART";let w=()=>{let[e,t]=c.useState(!0),{person:a,setPerson:r,yourCandidatePerson:o,setYourCandidatePerson:n,selectedPerson:u,setPersonOutlier:h,selectedCompany:p,party:f,setParty:b,setFilterPerson:m,selectedDataSet:y,selectedBusinessType:C,selectedParty:w,selectedSort:_}=(0,i.j)(),[x,T]=c.useState(s.MAIN_VIEW),j=c.useCallback(async()=>{let e=await S.Parties.fetch();b(e.list)},[b]),A=c.useCallback(async()=>{await P.AVB("https://raw.githubusercontent.com/wevisdemo/thailand-election-2023/main/apps/mpasset/crawler/public/data/people.json").then(e=>{if(e){e.forEach(e=>{e.totalValueShare=e.totalValueShare||0,e.countCompShare=e.countCompShare||0,e.countDirector=e.countDirector||0,e.totalPctShare=e.totalPctShare||0});let t=e.sort((e,t)=>t.totalValueShare-e.totalValueShare);t=(0,E.n9)(e,"countCompShare","countDirector"),console.log("fetch from git");let a=t.slice(0,1);h(t.slice(0,1)),r([...a.map(e=>({...e,totalPctShare:30})),...t.slice(1)])}})},[r,h]),M=c.useCallback(async()=>{await P.AVB("https://raw.githubusercontent.com/wevisdemo/thailand-election-2023/main/apps/mpasset/crawler/public/data/yourcandidate/people.json").then(e=>{if(e){e.forEach(e=>{e.MpType=e.MpType||"บัญชีรายชื่อ",e.Images="".concat("https://election66.wevis.info","/yourcandidates/candidates/").concat(e.PartyName,"/").concat(e.Name.replaceAll(" ","-"),".webp")}),e.forEach(e=>{e.totalPctShare=e.totalPctShare>30?30:e.totalPctShare});let t=e.sort((e,t)=>t.totalPctShare-e.totalPctShare);t=(0,E.n9)(e,"countCompShare","countDirector"),n(t=(0,E.n9)(e,"totalValueShare","countDirector")),m(t)}})},[n,m]);return c.useEffect(()=>{let e=!1;return a.length<=0&&f.length<=0&&o.length<=0?e||(A(),j(),M(),t(!1)):t(!1),()=>{e=!0}},[a,r,f,b,A,j,o,M]),c.useLayoutEffect(()=>{p?T(s.SELECTED_COMPANY_CHART):u?T(s.SELCTED_PERSON_CHART):T(s.MAIN_VIEW)},[u,p]),c.useMemo(async()=>{if(a.length>0&&o.length>0){let e=[];"นักการเมือง 62"===y?e=a:"ผู้สมัคร 66"===y&&(e=o),C&&"all"!==C.code&&(e=e.filter(e=>e.companyType.includes(C.code))),w&&"สภาผู้แทนราษฎร"===w.Name?e=e.filter(e=>!0===e.IsMp):w&&"วุฒิสภา"===w.Name?e=e.filter(e=>!0===e.IsSenator):w&&"คณะรัฐมนตรี"===w.Name?e=e.filter(e=>!0===e.IsCabinet):w&&"ทุกพรรค"!==w.Name&&(e=e.filter(e=>{var t;return(null===(t=e.Party)||void 0===t?void 0:t.Id)===(null==w?void 0:w.Id)})),e="desc"===_?e.sort((e,t)=>t.totalValueShare-e.totalValueShare):e.sort((e,t)=>e.totalValueShare-t.totalValueShare),m((0,E.n9)(e,"countCompShare","countDirector"))}},[C,w,_,m,a,o,y]),(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"h-full inset-0 flex flex-col relative overflow-hidden",children:[(0,l.jsx)(N,{}),(0,l.jsx)(g,{open:x===s.SELCTED_PERSON_CHART,children:(0,l.jsx)(v,{})}),(0,l.jsx)(g,{open:x===s.SELECTED_COMPANY_CHART,children:(0,l.jsx)(D,{})}),(0,l.jsx)(g,{open:e,children:(0,l.jsx)(d.a,{})})]})})};var _=w},2069:function(e,t,a){function r(e,t,a){return e.filter(e=>Number(e[t])>0).concat(e.filter(e=>0==Number(e[t])).sort((e,t)=>Number(t[a])-Number(e[a])))}function o(e){let t=Math.abs(Number(e))>=1e9?(Math.abs(Number(e))/1e9).toFixed(2)+"B":Math.abs(Number(e))>=1e6?(Math.abs(Number(e))/1e6).toFixed(2)+"M":Math.abs(Number(e))>=1e3?(Math.abs(Number(e))/1e3).toFixed(2)+"K":Math.abs(Number(e))+"฿";return e>0?t:"-".concat(t)}function n(e){return e.toString().replace(RegExp("\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))","g"),",")}a.d(t,{B0:function(){return o},n9:function(){return r},x6:function(){return n}})},7725:function(e,t,a){a.d(t,{j:function(){return n}});var r=a(624),o=a(7832);let n=(0,r.Ue)()((0,o.tJ)((e,t)=>({person:[],setPerson:t=>e(e=>({...e,person:t})),personOutlier:[],setPersonOutlier:t=>e(e=>({...e,personOutlier:t})),yourCandidatePerson:[],setYourCandidatePerson:t=>e(e=>({...e,yourCandidatePerson:t})),filterPerson:[],setFilterPerson:t=>e(e=>({...e,filterPerson:t})),selectedPerson:void 0,setSelectedPerson:t=>e(e=>({...e,selectedPerson:t})),directorData:[],setDirectorData:t=>e(e=>({...e,directorData:t})),shareholderData:[],setShareholderData:t=>e(e=>({...e,shareholderData:t})),selectedCompany:void 0,setSelectedCompany:t=>e(e=>({...e,selectedCompany:t})),selectedDataSet:"ผู้สมัคร 66",setSelectedDataSet:t=>e(e=>({...e,selectedDataSet:t})),selectedBusinessType:void 0,setSelectedBusinessType:t=>e(e=>({...e,selectedBusinessType:t})),party:[],setParty:t=>e(e=>({...e,party:t})),selectedParty:void 0,setSelectedParty:t=>e(e=>({...e,selectedParty:t})),selectedSort:"desc",toggleSort:()=>e(e=>({...e,selectedSort:"asc"===e.selectedSort?"desc":"asc"}))}),{name:"person",storage:(0,o.FL)(()=>sessionStorage),partialize:e=>({...Object.fromEntries(Object.entries(e).filter(e=>{let[t]=e;return["person","personOutlier","yourCandidatePerson","party"].includes(t)})),filterPerson:e.person}),onRehydrateStorage:e=>(console.log("hydration starts"),(e,t)=>{t?console.log("an error happened during hydration",t):console.log("hydration finished")})}))}}]);